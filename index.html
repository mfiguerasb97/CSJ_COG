<!DOCTYPE html>
<html lang="ca">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="manifest" href="manifest.json">
    <title>Sem√†for del Comportament</title>
    <link rel="stylesheet" href="styles.css">
    <style>
        body {
            font-family: Arial, sans-serif;
            text-align: center;
            font-size: 24px;
        }
        .behaviour-buttons {
            display: flex;
            justify-content: center;
            gap: 40px;
            margin: 20px 0;
        }
        .emoji {
            width: 64px;
            height: 64px;
            margin-right: 10px;
        }
        .button {
            font-size: 24px;
            padding: 20px 30px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            color: white;
            transition: background-color 0.3s;
        }
        .green {
            background-color: green;
        }
        .yellow {
            background-color: gold;
        }
        .red {
            background-color: red;
        }
        .clear-history-button {
            position: absolute;
            bottom: 20px;
            right: 20px;
            font-size: 18px;
        }
        .button-container {
            margin-top: 30px;
        }
        .delete-icon {
            margin-left: 10px;
            cursor: pointer;
        }
    </style>
</head>
<body>
    <h1>Sem√†for del Comportament</h1>
    
    <label for="name">Selecciona el teu nom:</label>
    <select id="name" style="font-size: 24px;">
        <!-- Llista completa de nens i nenes -->
        <option value="Danna Montserrat Alvarado">Danna Montserrat Alvarado</option>
        <option value="Leyre Masi Balderrama">Leyre Masi Balderrama</option>
        <option value="Ithaissa Culebras Tom√°s">Ithaissa Culebras Tom√°s</option>
        <option value="Amir Carmona Izagouaghen">Amir Carmona Izagouaghen</option>
        <option value="Yulia Luyana Duron Medina">Yulia Luyana Duron Medina</option>
        <option value="Nour Bakkali">Nour Bakkali</option>
        <option value="Martina Carmona Izagouaghen">Martina Carmona Izagouaghen</option>
        <option value="Lina Moreno Fiou√©">Lina Moreno Fiou√©</option>
        <option value="Yasmin Moreno Fiou√©">Yasmin Moreno Fiou√©</option>
        <option value="Nidal Ben Yessef">Nidal Ben Yessef</option>
        <option value="Elian Mart√≠nez P√©rez">Elian Mart√≠nez P√©rez</option>
        <option value="Dayara Villanueva Toribio">Dayara Villanueva Toribio</option>
        <option value="√Ångel P√©rez Molina">√Ångel P√©rez Molina</option>
        <option value="Genesis Plaza Garc√≠a">Genesis Plaza Garc√≠a</option>
        <option value="Nayara Reinoso Gonz√°lez">Nayara Reinoso Gonz√°lez</option>
        <option value="Carla Sanchez Fuentes">Carla Sanchez Fuentes</option>
        <option value="Edi Sanz Abadia">Edi Sanz Abadia</option>
        <option value="Aymane Toro">Aymane Toro</option>
        <option value="Nen 20">Nen 20</option>
        <!-- Afegeix la resta dels noms aqu√≠ -->
    </select>
    <button onclick="registerName()" style="font-size: 24px;">Entrar</button>

    <div id="comportament-section" style="display:none;">
        <h2 id="welcome-message"></h2>
        <p>Com t'has portat avui?</p>
        
        <!-- Botons amb icones de sem√†for -->
        <div class="behaviour-buttons">
            <button onclick="setComportament('verd')" class="button green">
                M'he portat molt b√© üòÅ
            </button>
            <button onclick="setComportament('groc')" class="button yellow">
                Puc millorar una mica el meu comportament üòê
            </button>
            <button onclick="setComportament('vermell')" class="button red">
                Encara he de millorar molt el meu comportament üò†
            </button>
        </div>

        <h3>Hist√≤ric de comportament:</h3>
        <ul id="comportament-log"></ul>

        <button onclick="clearHistory()" class="clear-history-button">Esborrar historial</button>

        <div class="button-container">
            <button onclick="exportToExcel()" style="font-size: 24px;">Exportar a Excel</button>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.16.9/xlsx.full.min.js"></script>
    <script>
        function registerName() {
            const name = document.getElementById('name').value;
            document.getElementById('welcome-message').innerText = 'Benvingut/da, ' + name;
            document.getElementById('comportament-section').style.display = 'block';
            loadComportamentLog(name);
        }

        function setComportament(color) {
            const name = document.getElementById('name').value;
            const date = new Date().toLocaleDateString();
            const comportamentData = JSON.parse(localStorage.getItem(name)) || [];

            comportamentData.push({ date, color });
            localStorage.setItem(name, JSON.stringify(comportamentData));
            loadComportamentLog(name);
        }

        function loadComportamentLog(name) {
            const comportamentLog = JSON.parse(localStorage.getItem(name)) || [];
            const logList = document.getElementById('comportament-log');
            logList.innerHTML = ''; // Esborra l'hist√≤ric anterior

            comportamentLog.forEach((entry, index) => {
                const listItem = document.createElement('li');
                let emoji = '';

                // Afegim emoticones en funci√≥ del color seleccionat
                if (entry.color === 'verd') emoji = 'üü¢ M\'he portat molt b√© üòÅ';
                else if (entry.color === 'groc') emoji = 'üü° Puc millorar una mica el meu comportament üòê';
                else if (entry.color === 'vermell') emoji = 'üî¥ Encara he de millorar molt el meu comportament üò†';

                listItem.innerHTML = `Data: ${entry.date}, Valoraci√≥: <span class="emoji">${emoji}</span>`;

                // Afegir icona de brossa per eliminar l'entrada
                const deleteIcon = document.createElement('img');
                deleteIcon.src = 'https://cdn-icons-png.flaticon.com/512/1214/1214428.png'; // Ic√≤na de brossa
                deleteIcon.alt = 'Eliminar';
                deleteIcon.width = 20;
                deleteIcon.height = 20;
                deleteIcon.classList.add('delete-icon');
                deleteIcon.onclick = () => deleteEntry(name, index);

                listItem.appendChild(deleteIcon);
                logList.appendChild(listItem);
            });
        }

        function deleteEntry(name, index) {
            const comportamentData = JSON.parse(localStorage.getItem(name)) || [];
            comportamentData.splice(index, 1); // Elimina l'element per l'√≠ndex
            localStorage.setItem(name, JSON.stringify(comportamentData));
            loadComportamentLog(name); // Recarrega la llista despr√©s de l'eliminaci√≥
        }

        function clearHistory() {
            const name = document.getElementById('name').value;
            localStorage.removeItem(name); // Esborra l'historial del nen seleccionat
            loadComportamentLog(name); // Actualitza l'hist√≤ric a la pantalla
        }

        function exportToExcel() {
            const noms = [
                "Danna Montserrat Alvarado", "Leyre Masi Balderrama", "Ithaissa Culebras Tom√°s","Amir Carmona Izagouaghen", "Yulia Luyana Duron Medina", "Nour Bakkali", "Amin Carmona Izagouaghen","Martina Carmona Izagouaghen","Lina Moreno Fiou√©","Yasmin Moreno Fiou√©","Nidal Ben Yessef","Elian Mart√≠nez P√©rez","Dayara Villanueva Toribio","√Ångel P√©rez Molina","Genesis Plaza Garc√≠a","Nayara Reinoso Gonz√°lez","Carla Sanchez Fuentes","Edi Sanz Abadia","Aymane Toro"
            ];
            const data = [];

            // Recull les dades de tots els nens
            noms.forEach(nom => {
                const historico = JSON.parse(localStorage.getItem(nom)) || [];
                historico.forEach(entry => {
                    data.push({
                        "Nom": nom,
                        "Data": entry.date,
                        "Valoraci√≥": entry.color
                    });
                });
            });

            const worksheet = XLSX.utils.json_to_sheet(data);
            const workbook = XLSX.utils.book_new();
            XLSX.utils.book_append_sheet(workbook, worksheet, "Comportament");
            XLSX.writeFile(workbook, "comportament_nens.xlsx");
        }
    </script>
</body>
</html>
<script>
    if ('serviceWorker' in navigator) {
        window.addEventListener('load', function() {
            navigator.serviceWorker.register('/service-worker.js').then(function(registration) {
                console.log('Service Worker registered with scope:', registration.scope);
            }, function(err) {
                console.log('Service Worker registration failed:', err);
            });
        });
    }
</script>
